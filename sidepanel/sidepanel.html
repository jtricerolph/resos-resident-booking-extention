<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resident Booking</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
  <div class="sidebar-container">

    <!-- Header -->
    <header class="sidebar-header">
      <div class="stats-bar">
        <div class="stat-item" title="Bookings with tables / total">
          <span class="material-symbols-outlined">hotel</span>
          <span id="stat-total">-</span>
        </div>
        <div class="stat-item" title="Arrivals with bookings / total">
          <span class="material-symbols-outlined">flight_land</span>
          <span id="stat-arrivals">-</span>
        </div>
        <div class="stat-item" title="Last nights with bookings / total">
          <span class="material-symbols-outlined">flight_takeoff</span>
          <span id="stat-departures">-</span>
        </div>
        <div class="stat-item stat-right" title="Total Resos bookings (covers)">
          <span class="material-symbols-outlined">table_restaurant</span>
          <span id="stat-resos-total">-</span>
        </div>
        <div class="stat-item" title="DBB bookings (covers)">
          <span class="material-symbols-outlined">room_service</span>
          <span id="stat-dbb">-</span>
        </div>
        <div class="stat-item" title="Non-resident bookings (covers)">
          <span class="material-symbols-outlined">directions_walk</span>
          <span id="stat-nonresident">-</span>
        </div>
        <div class="stat-item" title="Hotel guest bookings (covers)">
          <span class="material-symbols-outlined">king_bed</span>
          <span id="stat-hotelguest">-</span>
        </div>
      </div>
    </header>

    <!-- View: Not Configured -->
    <div id="view-not-configured" class="view hidden">
      <div class="empty-state">
        <span class="material-symbols-outlined">settings</span>
        <p>Please configure API settings before using the extension.</p>
        <button id="open-settings-btn" class="btn-primary">Open Settings</button>
      </div>
    </div>

    <!-- View: No Day Selected -->
    <div id="view-no-day" class="view hidden">
      <div class="empty-state">
        <span class="material-symbols-outlined">calendar_today</span>
        <p>Please select a day to show list of hotel residents.</p>
      </div>
    </div>

    <!-- View: Loading -->
    <div id="view-loading" class="view hidden">
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Loading hotel guests...</p>
      </div>
    </div>

    <!-- View: Error -->
    <div id="view-error" class="view hidden">
      <div class="error-state">
        <span class="material-symbols-outlined">error</span>
        <p id="error-message"></p>
        <button id="error-retry-btn" class="btn-primary">Retry</button>
      </div>
    </div>

    <!-- View: Guest List -->
    <div id="view-guest-list" class="view hidden">
      <div class="filter-bar">
        <label class="filter-toggle">
          <input type="checkbox" id="filter-matched" checked>
          <span>Hide with existing booking</span>
        </label>
        <span id="hidden-count" class="hidden-count-badge hidden">0</span>
      </div>

      <div class="search-bar">
        <span class="material-symbols-outlined">search</span>
        <input type="text" id="guest-search" placeholder="Search guests..." />
      </div>

      <div id="guest-list" class="guest-list"></div>

      <div class="bottom-bar">
        <button id="refresh-btn" class="btn-refresh">
          <span class="material-symbols-outlined">refresh</span>
          Refresh
        </button>
        <button id="mark-all-left-btn" class="btn-mark-left hidden">
          <span class="material-symbols-outlined">logout</span>
          Mark past as left
        </button>
      </div>
    </div>

    <!-- View: Confirm Booking -->
    <div id="view-confirm" class="view hidden">
      <button id="back-to-list-btn" class="back-btn">
        <span class="material-symbols-outlined">arrow_back</span>
        Back to guest list
      </button>

      <div class="confirm-card">
        <h2 id="confirm-guest-name"></h2>
        <div class="confirm-details">
          <div class="confirm-detail">
            <span class="material-symbols-outlined">tag</span>
            <span>Booking #<strong id="confirm-booking-id"></strong></span>
          </div>
          <div class="confirm-detail">
            <span class="material-symbols-outlined">meeting_room</span>
            <span>Room <strong id="confirm-room"></strong></span>
          </div>
          <div class="confirm-detail">
            <span class="material-symbols-outlined">calendar_today</span>
            <span id="confirm-date"></span>
          </div>
        </div>
      </div>

      <!-- Covers -->
      <div id="covers-form" class="form-section">
        <div class="form-group">
          <label for="confirm-covers">Covers</label>
          <input type="number" id="confirm-covers" min="1" max="20" />
        </div>
      </div>

      <!-- Time Slots (both today and future) -->
      <div id="timeslots-section" class="tables-section hidden">
        <div id="timeslots-loading" class="tables-loading hidden">
          <div class="spinner-sm"></div>
          <span>Loading available times...</span>
        </div>
        <div id="timeslots-list"></div>
        <div id="timeslots-empty" class="tables-empty hidden">
          <p>No available times for this date and party size.</p>
        </div>
        <div id="timeslots-error" class="tables-error hidden">
          <p id="timeslots-error-message"></p>
        </div>
      </div>

      <!-- Available Tables (today only, shown after time selection) -->
      <div id="tables-section" class="tables-section hidden">
        <div id="tables-loading" class="tables-loading hidden">
          <div class="spinner-sm"></div>
          <span>Loading tables...</span>
        </div>
        <div id="tables-list"></div>
        <div id="tables-empty" class="tables-empty hidden">
          <p>No tables available for this time and party size.</p>
        </div>
        <div id="tables-error" class="tables-error hidden">
          <p id="tables-error-message"></p>
        </div>
      </div>

      <button id="create-booking-btn" class="btn-primary btn-full" disabled>
        <span class="material-symbols-outlined">restaurant</span>
        Create Resos Booking
      </button>

      <div id="create-feedback" class="feedback hidden"></div>
    </div>

    <!-- View: Success -->
    <div id="view-success" class="view hidden">
      <div class="success-state">
        <span class="material-symbols-outlined">check_circle</span>
        <h2>Booking Created!</h2>
        <p id="success-message"></p>
        <button id="success-done-btn" class="btn-primary">Done</button>
      </div>
    </div>

  </div>

  <!-- Mark Past as Left Confirmation Modal -->
  <div id="mark-left-modal" class="modal-overlay hidden">
    <div class="modal-card">
      <h3>Mark past as left?</h3>
      <p class="modal-subtitle">The following bookings will be updated:</p>
      <ul id="mark-left-modal-list" class="modal-list"></ul>
      <div class="modal-actions">
        <button id="mark-left-cancel" class="btn-modal-cancel">Cancel</button>
        <button id="mark-left-confirm" class="btn-modal-confirm">Confirm</button>
      </div>
    </div>
  </div>

  <script src="sidepanel.js"></script>
</body>
</html>
